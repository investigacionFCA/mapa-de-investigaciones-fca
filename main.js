
const addresses = {
    "type": "FeatureCollection",
    "features": [
      {
      "type": "Feature",
      "properties": {
        "name": "PARASITISMO DE HUEVOS DE PENTATOMIDAE EN SOJA Glycine max (L.) Merril EN EL DEPARTAMENTO DE ALTO PARANÁ",
        "CATEGORIA": "INVEST. DOCENTE",
        "description": '<strong>Capital Pride Parade</strong><p>The annual <a href="http://www.capitalpride.org/parade" target="_blank" title="Opens in a new window">Capital Pride Parade</a> makes its way through Dupont this Saturday. 4:30 p.m. Free.</p>',
        "DEPARTAMENTO": "Alto Paraná",
        "AREA TECNICA": "Protección Vegetal",
        "INVEST PRINCIPAL": "CABRAL ANTUNEZ; CLAUDIA CAROLINA",
        "zip": "CABRAL ANTUNEZ; CLAUDIA CAROLINA"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -54.9711836,
          -25.617554600000002
        
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "LaTonya",
        "zip": "43054"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.81,
        40.08
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Tiffany",
        "zip": "61232"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -90.73,
        41.44
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Delia",
        "zip": "90026"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -118.26,
        34.08
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Huyen",
        "zip": "91767"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -117.75,
        34.06
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Hector",
        "zip": "77021"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -95.36,
        29.7
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Sebas",
        "zip": "77021"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -95.36,
        29.7
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Eddie",
        "zip": "18424"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -75.54,
        41.25
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Betsy",
        "zip": "20745"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -77.02,
        38.78
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Vickie",
        "zip": "21921"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -75.8,
        39.64
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Cynthia",
        "zip": "36305"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -85.46,
        31.2
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Renee",
        "zip": "80105"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -104.04,
        39.62
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Erica",
        "zip": "71105"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -93.72,
        32.44
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Yolanda",
        "zip": "28560"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -77.04,
        35.11
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Sheree",
        "zip": "17101"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -76.88,
        40.26
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Ashley",
        "zip": "84009"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -111.99,
        40.54
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Madeline",
        "zip": "10603"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -73.79,
        41.07
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Bridgett",
        "zip": "10451"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -73.92,
        40.83
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Olga",
        "zip": "93307"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -119.01,
        35.29
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Karina",
        "zip": "46528"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -85.84,
        41.59
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Shacey",
        "zip": "43906"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -80.74,
        40.02
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Ashley",
        "zip": "31632"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -83.37,
        30.99
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Tyveka",
        "zip": "77028"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -95.28,
        29.83
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Naima",
        "zip": "78154"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -98.33,
        29.57
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Shelly",
        "zip": "93308"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -119.05,
        35.38
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Rose",
        "zip": "92021"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -116.94,
        32.8
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Manuel",
        "zip": "33130"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -80.2,
        25.77
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Bernadine",
        "zip": "20011"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -77.03,
        38.96
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Salma",
        "zip": "33703"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.64,
        27.81
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Pam",
        "zip": "70502"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -92.015063,
        30.226518
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Samantha",
        "zip": "37172"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -86.88,
        36.49
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Michael",
        "zip": "54484"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -90.08,
        44.79
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Caitlin",
        "zip": "94945"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -122.57,
        38.11
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Amber",
        "zip": "21532"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -78.93,
        39.65
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Rita",
        "zip": "11561"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -73.66,
        40.59
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Stephanie",
        "zip": "89121"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -115.07,
        36.12
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Alfredo",
        "zip": "60610"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -87.63,
        41.9
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Cache",
        "zip": "90019"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -118.35,
        34.05
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Savannah",
        "zip": "73401"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -97.14,
        34.19
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Rosanna",
        "zip": "45682"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.69,
        38.81
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Ayana",
        "zip": "48221"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -83.14,
        42.42
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Holly",
        "zip": "52060"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -90.68,
        42.07
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Bonnie",
        "zip": "33496"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -80.2,
        26.41
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Fatima",
        "zip": "98198"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -122.3,
        47.39
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Caroline",
        "zip": "77063"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -95.51,
        29.74
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Irene",
        "zip": "33130"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -80.2,
        25.77
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Jacqueline",
        "zip": "29388"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.1,
        34.87
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Jakai",
        "zip": "27105"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -80.28,
        36.17
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Najib",
        "zip": "55411"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -93.29,
        45.01
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Deborah",
        "zip": "46804"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -85.2,
        41.07
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Frederica",
        "zip": "60607"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -87.65,
        41.87
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Jillian",
        "zip": "44514"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -80.63,
        41.03
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Laquandra",
        "zip": "46804"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -85.2,
        41.07
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Larrissa",
        "zip": "54952"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -88.42,
        44.23
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Tracy",
        "zip": "21703"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -77.41,
        39.38
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Michelle",
        "zip": "55003"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -92.78,
        45.02
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Rosalie",
        "zip": "19138"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -75.16,
        40.06
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Erika",
        "zip": "90241"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -118.12,
        33.94
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Cory",
        "zip": "91701"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -117.55,
        34.13
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Lillie",
        "zip": "86504"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -109.18,
        35.89
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Cashmere",
        "zip": "20020"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -76.98,
        38.85
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Rosie",
        "zip": "77518"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -94.99,
        29.5
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Gail",
        "zip": "35131"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -86.16,
        33.74
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Heather",
        "zip": "53140"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -87.82,
        42.62
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Mazie",
        "zip": "52601"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -91.14,
        40.82
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Quesha",
        "zip": "75212"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -96.91,
        32.77
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Ingrid",
        "zip": "92882"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -117.57,
        33.88
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Emily",
        "zip": "17603"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -76.31,
        40.04
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Cindy",
        "zip": "24220"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.238587,
        37.130666
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Justin",
        "zip": "95340"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -120.48,
        37.3
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Diama",
        "zip": "76450"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -98.58,
        33.1
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Roodenson",
        "zip": "33321"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -80.25,
        26.21
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Louis",
        "zip": "15215"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -79.92,
        40.49
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Frankie",
        "zip": "32696"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.45,
        29.39
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Desire",
        "zip": "98499"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -122.51,
        47.17
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Jaelyn",
        "zip": "24085"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -79.81,
        37.69
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Jessica",
        "zip": "78213"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -98.54,
        29.49
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Desiree",
        "zip": "77441"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -95.87,
        29.7
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Isaiah",
        "zip": "93702"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -119.75,
        36.73
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Lisa",
        "zip": "30722"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -84.972361,
        34.771189
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Sofia",
        "zip": "33157"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -80.36,
        25.59
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "June",
        "zip": "23502"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -76.21,
        36.86
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Marilyn",
        "zip": "08330"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -74.64,
        39.45
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Samantha",
        "zip": "37923"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -84.09,
        35.92
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Shonda",
        "zip": "19904"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -75.53,
        39.16
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Tarik",
        "zip": "76109"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -97.37,
        32.71
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Emmett",
        "zip": "67147"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -97.37,
        37.84
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Julia",
        "zip": "90740"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -118.1,
        33.74
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Averie",
        "zip": "85392"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -112.34,
        33.46
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Crystal",
        "zip": "02149"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -71.05,
        42.42
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Kimberly",
        "zip": "38572"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -85.13,
        35.91
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Heather",
        "zip": "02148"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -71.07,
        42.43
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Lisa",
        "zip": "76244"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -97.27,
        32.91
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Helen",
        "zip": "60010"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -88.19,
        42.07
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Loran",
        "zip": "85716"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -110.92,
        32.22
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Kim",
        "zip": "94547"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -122.27,
        38.01
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Joyce",
        "zip": "45680"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.51,
        38.42
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Caren",
        "zip": "24085"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -79.81,
        37.69
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Enoch",
        "zip": "20716"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -76.73,
        38.94
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Breanne",
        "zip": "18643"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -75.8,
        41.33
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Felicia",
        "zip": "37031"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -86.34,
        36.39
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Jessica",
        "zip": "48040"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.48,
        42.92
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Patricia",
        "zip": "72036"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -91.26,
        34.97
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Crystal",
        "zip": "27824"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -76.04,
        35.54
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Evelinda",
        "zip": "77505"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -95.16,
        29.65
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Lisa",
        "zip": "44107"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -81.79,
        41.48
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Samantha",
        "zip": "33541"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.19,
        28.27
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Shelley",
        "zip": "92688"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -117.6,
        33.64
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Eleycia",
        "zip": "33428"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -80.21,
        26.33
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Lindsey",
        "zip": "60623"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -87.71,
        41.86
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Keira",
        "zip": "31093"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -83.67,
        32.62
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Alison",
        "zip": "90031"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -118.22,
        34.08
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Jan",
        "zip": "34202"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.44,
        27.39
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Ashley",
        "zip": "38637"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -90,
        34.96
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Jennifer",
        "zip": "17603"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -76.31,
        40.04
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Ana",
        "zip": "34207"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.58,
        27.46
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Samantha",
        "zip": "63901"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -90.42,
        36.77
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Morgan",
        "zip": "90805"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -118.2,
        33.87
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Andria",
        "zip": "45601"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -82.99,
        39.34
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Tina",
        "zip": "44305"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -81.47,
        41.07
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Maycon",
        "zip": "08882"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -74.38,
        40.43
        ]
      }
    },
    {
      "type": "Feature",
      "properties": {
        "name": "Cassandra",
        "zip": "93311"
      },
      "geometry": {
        "type": "Point",
        "coordinates": [
        -119.1,
        35.34
        ]
      }
    }
    ]
  }
  
  class ShowAllControl extends L.Control {
    onAdd(map) {
      this.map = map;
      this.container = document.createElement('div');
      this.container.className = 'map-show-all-control leaflet-bar leaflet-control';
      this.container.textContent = 'Show All';
      this.options.position = 'topleft';
      this.onClick = this.onClick.bind(this);
      this.initEvents();
  
      return this.container;
    }
    onRemove() {
      this.container.parentNode.removeChild(this.container);
      this.container.removeEventListener('click', this.onClick);
      this.map = undefined;
    }
    onClick() {
      let zoom = 4;
      if (window.innerWidth <= 960) {
        zoom = 3;
      }
  
      this.map.flyTo(
        SearchMap.mapCenter, 
        zoom, 
        { animate: true, duration: 1 }
        );
    }
    initEvents() {
      this.container.addEventListener('click', this.onClick);
    }
  }
  
  class SearchForm {
    onResultsClick = this.onResultsClick.bind(this);
    onClearBtnClick = this.onClearBtnClick.bind(this);
    onFormChange = this.onFormChange.bind(this);
    onFormSubmit = this.onFormSubmit.bind(this);
  
    constructor(searchMap) {
      this.searchMap = searchMap;
      this.map = searchMap.map;
      this.clusterGroup = map.clusterGroup;
  
      this.initElements();
      this.initEvents();
      this.render();
    }
    initElements() {
      this.mapResultsEl = document.querySelector('.map-search-results');
      this.mapClearBtnEl = document.querySelector('.map-clear-btn');
      this.mapSearchInputEl = document.querySelector('.map-search-input');
      this.mapResultsInfoEl = document.querySelector('.map-results-info');
      this.formEl = document.querySelector('.map-search-form');
    }
    initEvents() {
      this.mapResultsEl.addEventListener('click', this.onResultsClick);
      this.mapResultsEl.addEventListener('keyup', this.onResultsClick);
      this.mapClearBtnEl.addEventListener('click', this.onClearBtnClick);
      this.formEl.addEventListener('input', this.onFormChange);
      this.formEl.addEventListener('submit', this.onFormSubmit);
    }
    onFormSubmit(event) {
      const searchTerms = this.mapSearchInputEl.value;
      this.hideResultEl();
      if (searchTerms.length > 2) {
        this.search(searchTerms);
      }
    }
    onFormChange(event) {
      const searchTerms = this.mapSearchInputEl.value;
      if (searchTerms) {
        this.mapClearBtnEl.style.display = 'block';
      } else {
        this.mapClearBtnEl.style.display = 'none';
      }
    }
    onClearBtnClick(event) {
      event.preventDefault();
      this.mapClearBtnEl.style.display = 'none';
      this.hideResultEl();
      this.render();
      this.formEl.reset();
      this.searchMap.resetMap();
      this.mapSearchInputEl.focus();
    }
    onResultsClick(event) {
      const target = event.target;
      const { id } = target.dataset.length ? target.dataset : target.closest('li')?.dataset || {};
  
      if (!id) {
        return;
      }
  
      this.searchMap.showAddresses([id]);
    }
    render() {
      this.renderList(this.clusterGroup.getLayers());
      this.mapSearchInputEl.value = '';
    }
    renderList(list) {
      let html = '';
      list.forEach((layer, index) => {
        html += 
        `<li role="link" tabindex="0" data-id="${layer.options.id}" class="map-search-result">
          <address class="column">
            <span class="map-result-name inline-block">${layer.options.name}</span>
            <span class="map-result-zip inline-block">${layer.options.zip}</span>
          </address>
        </li>`;
      });
      this.mapResultsEl.innerHTML = html;
    }
    hideResultEl() {
      this.mapResultsInfoEl.style.opacity = 0;
    }
    showResultEl() {
      this.mapResultsInfoEl.style.opacity = 1;
    }
    async search(searchTerm) {
      const nameZipSearchResults = [];
      const normalizedSearchTerm = searchTerm.toLowerCase();
  
      this.clusterGroup.eachLayer(layer => {
        const hasNameTerm = layer.options.name.toLowerCase().indexOf(normalizedSearchTerm) > -1;
        const hasZipTerm = layer.options.zip == normalizedSearchTerm;
        
        if (hasZipTerm || hasNameTerm) {
          nameZipSearchResults.push(layer);
        } 
      });
  
      const addressRangeResults = await this.searchMap.getAddressesWithinRange(normalizedSearchTerm);
      const layers = Array.from(new Set([...nameZipSearchResults, ...addressRangeResults]));
  
      this.renderList(layers);
  
      if (layers.length === 0) {
        this.showResultEl();
      } else {
        this.searchMap.fitBounds(layers);
      }
    }
  }
  
  class SearchMap {
    static mapCenter = [-23.33563,-57.51449];
    ACCESS_TOKEN = 'pk.eyJ1IjoidGhpbmtmaXJzdCIsImEiOiJjanVrM21pcWwxbzkxNGRudnUwMHkyMG0wIn0.DPaK0L2_D5ShBY0GH9_oIQ';
    zoom = {
      mobile: 3,
      desktop: 4,
      cluster: 6,
    };
    constructor(geoJSON, searchControl) {
      this.searchControl = searchControl;
      this.render(geoJSON);
    }
    render(geoJSON) {
      L.mapbox.accessToken = this.ACCESS_TOKEN;
  
      this.map = L.mapbox.map('map')
      .setView(SearchMap.mapCenter, this.zoom.desktop)
      .addLayer(L.mapbox.styleLayer('mapbox://styles/mapbox/outdoors-v12'))
  
       
      if (window.innerWidth <= 768) {
        this.map.setZoom(this.zoom.mobile);
      }
  
      this.clusterGroup = new L.MarkerClusterGroup({
        maxClusterRadius: 25,
        disableClusteringAtZoom: this.zoom.cluster
      });
  
      geoJSON.features.forEach((feature, index) => {
        const title = feature.properties.name+ "<br>"+ feature.properties.zip+"<br>"+feature.properties.description 
        const coords = feature.geometry.coordinates;
        const marker = L.marker(new L.LatLng(coords[1], coords[0]), {
          icon: L.mapbox.marker.icon({
            'marker-symbol': 'college', 
            'marker-color': '#ed6427'
          }),
          name: feature.properties.name,
          zip: feature.properties.zip,
          id: index
        });
//AQUI SE AGREGA CODIGO PARA TOOLTIP+POPUP!//
       
        marker.bindTooltip(title);
        marker.bindPopup(title);
        this.clusterGroup.addLayer(marker);
      });
  
      this.map.addLayer(this.clusterGroup);
      this.map.addControl(this.searchControl);
    }
    closeAllToolTips() {
      this.clusterGroup.eachLayer(layer => {
        layer.closeTooltip();
      });
    }
    showToolTips(layers) {
      console.log('show');
      layers.forEach(layer => layer.openTooltip());
    }
    showAddresses(ids=[]) {
      this.clusterGroup.eachLayer(layer => {
        if (ids.includes(String(layer.options.id))) {
          const { lat, lng } = layer.getLatLng();
          this.map.once('zoomend', () => layer.openTooltip());
          this.map.flyTo([lat,lng], this.zoom.cluster, 2);
        } else {
          layer.closeTooltip();
        }
      });
    }
    fitBounds(layers) {
      const coordinates = layers.map(layer => layer.getLatLng());
      this.closeAllToolTips();
      this.map.once('moveend', () => this.showToolTips(layers));
      this.map.fitBounds(coordinates, { minZoom: 6, maxZoom: 6 });  
    }
    resetMap() {
      this.closeAllToolTips();
      this.searchControl.onClick();
    }
    async getAddressesWithinRange(place, range=10) {
      const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${place}.json?
      country=us&types=place%2Cpostcode%2Caddress&access_token=${this.ACCESS_TOKEN}`;
      const results = [];    
      let zipCodeCoords = [];
  
      try {
        const response = await fetch(url);
        const json = await response.json();
  
        if (json.type) {
          zipCodeCoords = json?.features[0]?.center;
        }
      } catch(error) {
        console.log(error);
      }
  
      map.on('click', 'places', (e) => {
              // Copy coordinates array.
              const coordinates = e.features[0].geometry.coordinates.slice();
              const title = e.features[0].properties.title;
  
              // Ensure that if the map is zoomed out such that multiple
              // copies of the feature are visible, the popup appears
              // over the copy being pointed to.
              while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
                  coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
              }
  
              new map.Popup()
                  .setLngLat(coordinates)
                  .setHTML(title)
                  .addTo(map);
          });
  
          // Change the cursor to a pointer when the mouse is over the places layer.
          map.on('mouseenter', 'places', () => {
              map.getCanvas().style.cursor = 'pointer';
          });
  
          // Change it back to a pointer when it leaves.
          map.on('mouseleave', 'places', () => {
              map.getCanvas().style.cursor = '';
          });
      
      
      
      if (zipCodeCoords?.length) {
        const latLng = new L.LatLng(zipCodeCoords[1], zipCodeCoords[0]);
        const meters = range * 1609.34;
  
        this.clusterGroup.eachLayer(layer => {
          const distance = latLng.distanceTo(layer.getLatLng());
          
          if (distance < meters) {
            results.push(layer);
          };
        });
      }
  
      return results;
    }
  };
  
  
  
  const searchControl = new ShowAllControl();
  const map = new SearchMap(addresses, searchControl);
  new SearchForm(map);
  
  
  